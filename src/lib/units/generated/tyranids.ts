export type Unit = {
  id: string;
  name: string;
  baseCost: number;
  costTiers: Record<number, number>;
  modelsPerUnit: { min: number; max: number };
  wounds: number;
  toughness: number;
  save: number;
  invulnSave?: number;
};

export const UNITS: Unit[] = [
  {
    id: "barbed-hierodule-000000503",
    name: "Barbed Hierodule",
    baseCost: 340,
    costTiers: {"1":340},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 18,
    toughness: 12,
    save: 2,
  },
  {
    id: "barbgaunts-000002686",
    name: "Barbgaunts",
    baseCost: 55,
    costTiers: {"5":55,"10":110},
    modelsPerUnit: { min: 5, max: 10 },
    wounds: 2,
    toughness: 4,
    save: 4,
  },
  {
    id: "biovores-000000491",
    name: "Biovores",
    baseCost: 50,
    costTiers: {"1":50,"2":100,"3":150},
    modelsPerUnit: { min: 1, max: 3 },
    wounds: 5,
    toughness: 6,
    save: 3,
  },
  {
    id: "broodlord-000000463",
    name: "Broodlord",
    baseCost: 80,
    costTiers: {"1":80},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 5,
    save: 4,
    invulnSave: 4,
  },
  {
    id: "carnifexes-000000490",
    name: "Carnifexes",
    baseCost: 115,
    costTiers: {"1":115,"2":230},
    modelsPerUnit: { min: 1, max: 2 },
    wounds: 8,
    toughness: 9,
    save: 2,
  },
  {
    id: "deathleaper-000000479",
    name: "Deathleaper",
    baseCost: 80,
    costTiers: {"1":80},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 7,
    toughness: 6,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "dimachaeron-000000500",
    name: "Dimachaeron",
    baseCost: 200,
    costTiers: {"1":200},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 16,
    toughness: 10,
    save: 3,
    invulnSave: 5,
  },
  {
    id: "exocrine-000000495",
    name: "Exocrine",
    baseCost: 140,
    costTiers: {"1":140},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 14,
    toughness: 10,
    save: 3,
  },
  {
    id: "gargoyles-000000484",
    name: "Gargoyles",
    baseCost: 85,
    costTiers: {"10":85,"20":170},
    modelsPerUnit: { min: 10, max: 20 },
    wounds: 1,
    toughness: 3,
    save: 6,
  },
  {
    id: "genestealers-000000467",
    name: "Genestealers",
    baseCost: 75,
    costTiers: {"5":75,"10":150},
    modelsPerUnit: { min: 5, max: 10 },
    wounds: 2,
    toughness: 4,
    save: 5,
    invulnSave: 5,
  },
  {
    id: "harpy-000000485",
    name: "Harpy",
    baseCost: 215,
    costTiers: {"1":215},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 12,
    toughness: 9,
    save: 3,
  },
  {
    id: "harridan-000000504",
    name: "Harridan",
    baseCost: 610,
    costTiers: {"1":610},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 30,
    toughness: 10,
    save: 3,
  },
  {
    id: "haruspex-000000478",
    name: "Haruspex",
    baseCost: 125,
    costTiers: {"1":125},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 14,
    toughness: 11,
    save: 3,
  },
  {
    id: "hierophant-000000505",
    name: "Hierophant",
    baseCost: 810,
    costTiers: {"1":810},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 30,
    toughness: 14,
    save: 2,
    invulnSave: 5,
  },
  {
    id: "hive-crone-000000486",
    name: "Hive Crone",
    baseCost: 200,
    costTiers: {"1":200},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 12,
    toughness: 9,
    save: 3,
  },
  {
    id: "hive-guard-000000472",
    name: "Hive Guard",
    baseCost: 90,
    costTiers: {"3":90,"6":180},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 4,
    toughness: 7,
    save: 3,
  },
  {
    id: "hive-tyrant-000000460",
    name: "Hive Tyrant",
    baseCost: 195,
    costTiers: {"1":195},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 10,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "hormagaunts-000000469",
    name: "Hormagaunts",
    baseCost: 65,
    costTiers: {"10":65,"20":130},
    modelsPerUnit: { min: 10, max: 20 },
    wounds: 1,
    toughness: 3,
    save: 5,
  },
  {
    id: "hyperadapted-raveners-000004117",
    name: "Hyperadapted Raveners",
    baseCost: 165,
    costTiers: {"5":165},
    modelsPerUnit: { min: 5, max: 5 },
    wounds: 6,
    toughness: 5,
    save: 4,
  },
  {
    id: "lictor-000000473",
    name: "Lictor",
    baseCost: 60,
    costTiers: {"1":60},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 6,
    save: 4,
  },
  {
    id: "malanthrope-000000499",
    name: "Malanthrope",
    baseCost: 75,
    costTiers: {"1":75},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 5,
    save: 4,
  },
  {
    id: "maleceptor-000000474",
    name: "Maleceptor",
    baseCost: 170,
    costTiers: {"1":170},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 14,
    toughness: 11,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "mawloc-000000494",
    name: "Mawloc",
    baseCost: 145,
    costTiers: {"1":145},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 14,
    toughness: 10,
    save: 3,
  },
  {
    id: "mucolid-spores-000000487",
    name: "Mucolid Spores",
    baseCost: 30,
    costTiers: {"1":30,"2":60},
    modelsPerUnit: { min: 1, max: 2 },
    wounds: 3,
    toughness: 4,
    save: 7,
  },
  {
    id: "neurogaunts-000002687",
    name: "Neurogaunts",
    baseCost: 45,
    costTiers: {"11":45,"22":90},
    modelsPerUnit: { min: 11, max: 22 },
    wounds: 1,
    toughness: 3,
    save: 6,
  },
  {
    id: "neurolictor-000002753",
    name: "Neurolictor",
    baseCost: 80,
    costTiers: {"1":80},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 7,
    toughness: 5,
    save: 4,
    invulnSave: 4,
  },
  {
    id: "neurotyrant-000002688",
    name: "Neurotyrant",
    baseCost: 105,
    costTiers: {"1":105},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 9,
    toughness: 8,
    save: 4,
    invulnSave: 4,
  },
  {
    id: "norn-assimilator-000002752",
    name: "Norn Assimilator",
    baseCost: 275,
    costTiers: {"1":275},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 16,
    toughness: 11,
    save: 2,
  },
  {
    id: "norn-emissary-000002751",
    name: "Norn Emissary",
    baseCost: 260,
    costTiers: {"1":260},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 16,
    toughness: 11,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "old-one-eye-000000462",
    name: "Old One Eye",
    baseCost: 150,
    costTiers: {"1":150},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 9,
    toughness: 9,
    save: 2,
  },
  {
    id: "parasite-of-mortrex-000002529",
    name: "Parasite Of Mortrex",
    baseCost: 80,
    costTiers: {"1":80},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 5,
    toughness: 5,
    save: 4,
  },
  {
    id: "psychophage-000002689",
    name: "Psychophage",
    baseCost: 110,
    costTiers: {"1":110},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 9,
    save: 3,
  },
  {
    id: "pyrovores-000000477",
    name: "Pyrovores",
    baseCost: 40,
    costTiers: {"1":40,"2":70,"3":105},
    modelsPerUnit: { min: 1, max: 3 },
    wounds: 5,
    toughness: 6,
    save: 3,
  },
  {
    id: "raveners-000000482",
    name: "Raveners",
    baseCost: 125,
    costTiers: {"5":125},
    modelsPerUnit: { min: 5, max: 5 },
    wounds: 3,
    toughness: 5,
    save: 4,
  },
  {
    id: "ripper-swarms-000000470",
    name: "Ripper Swarms",
    baseCost: 25,
    costTiers: {"1":25,"2":40,"3":50},
    modelsPerUnit: { min: 1, max: 3 },
    wounds: 4,
    toughness: 2,
    save: 6,
  },
  {
    id: "screamer-killer-000002690",
    name: "Screamer-killer",
    baseCost: 135,
    costTiers: {"1":135},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 9,
    save: 2,
  },
  {
    id: "scythed-hierodule-000000506",
    name: "Scythed Hierodule",
    baseCost: 330,
    costTiers: {"1":330},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 18,
    toughness: 12,
    save: 2,
  },
  {
    id: "sky-slasher-swarms-000000483",
    name: "Sky-slasher Swarms",
    baseCost: 60,
    costTiers: {"3":60},
    modelsPerUnit: { min: 3, max: 3 },
    wounds: 4,
    toughness: 2,
    save: 6,
  },
  {
    id: "spore-mines-000000488",
    name: "Spore Mines",
    baseCost: 55,
    costTiers: {"3":55,"6":110},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 1,
    toughness: 1,
    save: 7,
  },
  {
    id: "sporocyst-000000498",
    name: "Sporocyst",
    baseCost: 145,
    costTiers: {"1":145},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 10,
    save: 3,
  },
  {
    id: "termagants-000000468",
    name: "Termagants",
    baseCost: 60,
    costTiers: {"10":60,"20":120},
    modelsPerUnit: { min: 10, max: 20 },
    wounds: 1,
    toughness: 3,
    save: 5,
  },
  {
    id: "tervigon-000000465",
    name: "Tervigon",
    baseCost: 175,
    costTiers: {"1":175},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 16,
    toughness: 11,
    save: 2,
  },
  {
    id: "the-swarmlord-000000461",
    name: "The Swarmlord",
    baseCost: 220,
    costTiers: {"1":220},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 10,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "toxicrene-000000497",
    name: "Toxicrene",
    baseCost: 150,
    costTiers: {"1":150},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 14,
    toughness: 11,
    save: 3,
  },
  {
    id: "trygon-000000493",
    name: "Trygon",
    baseCost: 140,
    costTiers: {"1":140},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 14,
    toughness: 10,
    save: 3,
  },
  {
    id: "tyranid-warriors-with-melee-bio-weapons-000002691",
    name: "Tyranid Warriors With Melee Bio-weapons",
    baseCost: 75,
    costTiers: {"3":75,"6":150},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 3,
    toughness: 5,
    save: 4,
  },
  {
    id: "tyranid-warriors-with-ranged-bio-weapons-000002692",
    name: "Tyranid Warriors With Ranged Bio-weapons",
    baseCost: 65,
    costTiers: {"3":65,"6":130},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 3,
    toughness: 5,
    save: 4,
  },
  {
    id: "tyrannocyte-000000489",
    name: "Tyrannocyte",
    baseCost: 105,
    costTiers: {"1":105},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 9,
    save: 3,
  },
  {
    id: "tyrannofex-000000496",
    name: "Tyrannofex",
    baseCost: 200,
    costTiers: {"1":200},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 16,
    toughness: 12,
    save: 2,
  },
  {
    id: "tyrant-guard-000000471",
    name: "Tyrant Guard",
    baseCost: 80,
    costTiers: {"3":80,"6":160},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 4,
    toughness: 8,
    save: 3,
  },
  {
    id: "venomthropes-000000476",
    name: "Venomthropes",
    baseCost: 70,
    costTiers: {"3":70,"6":140},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 3,
    toughness: 5,
    save: 4,
  },
  {
    id: "von-ryan-s-leapers-000002693",
    name: "Von Ryanâ€™s Leapers",
    baseCost: 70,
    costTiers: {"3":70,"6":140},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 3,
    toughness: 5,
    save: 4,
    invulnSave: 6,
  },
  {
    id: "winged-hive-tyrant-000002528",
    name: "Winged Hive Tyrant",
    baseCost: 170,
    costTiers: {"1":170},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 9,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "winged-tyranid-prime-000002694",
    name: "Winged Tyranid Prime",
    baseCost: 65,
    costTiers: {"1":65},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 5,
    save: 4,
  },
  {
    id: "zoanthropes-000000475",
    name: "Zoanthropes",
    baseCost: 100,
    costTiers: {"3":100,"6":200},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 3,
    toughness: 5,
    save: 5,
    invulnSave: 4,
  },
];

export function getUnitById(id: string): Unit | undefined {
  return UNITS.find(u => u.id === id);
}

export function calculateUnitCost(unit: Unit, modelCount: number): number {
  if (unit.costTiers[modelCount] != null) return unit.costTiers[modelCount];
  const sizes = Object.keys(unit.costTiers).map(n => parseInt(n, 10)).sort((a,b)=>a-b);
  const within = sizes.filter(n => n >= unit.modelsPerUnit.min && n <= unit.modelsPerUnit.max);
  if (within.length === 0) return 0;
  let closest = within[0]; let best = Math.abs(modelCount - closest);
  for (const n of within) { const d = Math.abs(modelCount - n); if (d < best) { best = d; closest = n; } }
  return unit.costTiers[closest] ?? 0;
}
