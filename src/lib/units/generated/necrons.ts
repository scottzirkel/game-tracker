export type Unit = {
  id: string;
  name: string;
  baseCost: number;
  costTiers: Record<number, number>;
  modelsPerUnit: { min: number; max: number };
  wounds: number;
  toughness: number;
  save: number;
  invulnSave?: number;
};

export const UNITS: Unit[] = [
  {
    id: "annihilation-barge-000000553",
    name: "Annihilation Barge",
    baseCost: 105,
    costTiers: {"1":105},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 9,
    toughness: 8,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "anrakyr-the-traveller-000000531",
    name: "Anrakyr The Traveller",
    baseCost: 95,
    costTiers: {"1":95},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 5,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "c-tan-shard-of-the-deceiver-000000542",
    name: "C’tan Shard Of The Deceiver",
    baseCost: 265,
    costTiers: {"1":265},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 12,
    toughness: 11,
    save: 4,
    invulnSave: 4,
  },
  {
    id: "c-tan-shard-of-the-void-dragon-000002357",
    name: "C’tan Shard Of The Void Dragon",
    baseCost: 300,
    costTiers: {"1":300},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 12,
    toughness: 11,
    save: 4,
    invulnSave: 4,
  },
  {
    id: "canoptek-acanthrites-000000559",
    name: "Canoptek Acanthrites",
    baseCost: 85,
    costTiers: {"3":85,"6":170},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 2,
    toughness: 5,
    save: 3,
  },
  {
    id: "canoptek-doomstalker-000002115",
    name: "Canoptek Doomstalker",
    baseCost: 140,
    costTiers: {"1":140},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 12,
    toughness: 8,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "canoptek-reanimator-000002112",
    name: "Canoptek Reanimator",
    baseCost: 75,
    costTiers: {"1":75},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 6,
    save: 3,
  },
  {
    id: "canoptek-scarab-swarms-000002114",
    name: "Canoptek Scarab Swarms",
    baseCost: 40,
    costTiers: {"3":40,"6":80},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 4,
    toughness: 2,
    save: 6,
  },
  {
    id: "canoptek-spyders-000000551",
    name: "Canoptek Spyders",
    baseCost: 75,
    costTiers: {"1":75,"2":150},
    modelsPerUnit: { min: 1, max: 2 },
    wounds: 6,
    toughness: 7,
    save: 3,
  },
  {
    id: "canoptek-tomb-sentinel-000000560",
    name: "Canoptek Tomb Sentinel",
    baseCost: 115,
    costTiers: {"1":115},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 9,
    toughness: 9,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "canoptek-tomb-stalker-000000558",
    name: "Canoptek Tomb Stalker",
    baseCost: 130,
    costTiers: {"1":130},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 9,
    toughness: 9,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "canoptek-wraiths-000000546",
    name: "Canoptek Wraiths",
    baseCost: 110,
    costTiers: {"3":110,"6":220},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 4,
    toughness: 6,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "catacomb-command-barge-000000533",
    name: "Catacomb Command Barge",
    baseCost: 120,
    costTiers: {"1":120},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 9,
    toughness: 8,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "chronomancer-000002354",
    name: "Chronomancer",
    baseCost: 65,
    costTiers: {"1":65},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 4,
    toughness: 4,
    save: 4,
    invulnSave: 4,
  },
  {
    id: "convergence-of-dominion-000002361",
    name: "Convergence Of Dominion",
    baseCost: 60,
    costTiers: {"1":60,"2":120,"3":180},
    modelsPerUnit: { min: 1, max: 3 },
    wounds: 7,
    toughness: 9,
    save: 3,
  },
  {
    id: "cryptothralls-000002111",
    name: "Cryptothralls",
    baseCost: 60,
    costTiers: {"2":60},
    modelsPerUnit: { min: 2, max: 2 },
    wounds: 3,
    toughness: 4,
    save: 3,
  },
  {
    id: "deathmarks-000000537",
    name: "Deathmarks",
    baseCost: 60,
    costTiers: {"5":60,"10":120},
    modelsPerUnit: { min: 5, max: 10 },
    wounds: 1,
    toughness: 5,
    save: 3,
  },
  {
    id: "doom-scythe-000000545",
    name: "Doom Scythe",
    baseCost: 230,
    costTiers: {"1":230},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 12,
    toughness: 9,
    save: 3,
  },
  {
    id: "doomsday-ark-000000554",
    name: "Doomsday Ark",
    baseCost: 200,
    costTiers: {"1":200},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 14,
    toughness: 9,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "flayed-ones-000000538",
    name: "Flayed Ones",
    baseCost: 60,
    costTiers: {"5":60,"10":120},
    modelsPerUnit: { min: 5, max: 10 },
    wounds: 1,
    toughness: 4,
    save: 4,
  },
  {
    id: "gauss-pylon-000000567",
    name: "Gauss Pylon",
    baseCost: 210,
    costTiers: {"1":210},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 22,
    toughness: 12,
    save: 3,
    invulnSave: 5,
  },
  {
    id: "ghost-ark-000000543",
    name: "Ghost Ark",
    baseCost: 115,
    costTiers: {"1":115},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 14,
    toughness: 9,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "hexmark-destroyer-000002355",
    name: "Hexmark Destroyer",
    baseCost: 75,
    costTiers: {"1":75},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 5,
    toughness: 5,
    save: 3,
  },
  {
    id: "illuminor-szeras-000002092",
    name: "Illuminor Szeras",
    baseCost: 165,
    costTiers: {"1":165},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 9,
    toughness: 8,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "immortals-000000535",
    name: "Immortals",
    baseCost: 70,
    costTiers: {"5":70,"10":150},
    modelsPerUnit: { min: 5, max: 10 },
    wounds: 1,
    toughness: 5,
    save: 3,
  },
  {
    id: "imotekh-the-stormlord-000000522",
    name: "Imotekh The Stormlord",
    baseCost: 100,
    costTiers: {"1":100},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 5,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "lokhust-destroyers-000002359",
    name: "Lokhust Destroyers",
    baseCost: 40,
    costTiers: {"1":40,"2":60,"3":90,"6":180},
    modelsPerUnit: { min: 1, max: 6 },
    wounds: 3,
    toughness: 6,
    save: 3,
  },
  {
    id: "lokhust-heavy-destroyers-000002116",
    name: "Lokhust Heavy Destroyers",
    baseCost: 55,
    costTiers: {"1":55,"2":110,"3":165},
    modelsPerUnit: { min: 1, max: 3 },
    wounds: 4,
    toughness: 6,
    save: 3,
  },
  {
    id: "lokhust-lord-000002351",
    name: "Lokhust Lord",
    baseCost: 80,
    costTiers: {"1":80},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 6,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "lord-000000524",
    name: "Lord",
    baseCost: 65,
    costTiers: {"1":65},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 4,
    toughness: 5,
    save: 3,
  },
  {
    id: "lychguard-000000536",
    name: "Lychguard",
    baseCost: 85,
    costTiers: {"5":85,"10":170},
    modelsPerUnit: { min: 5, max: 10 },
    wounds: 2,
    toughness: 5,
    save: 3,
  },
  {
    id: "monolith-000000552",
    name: "Monolith",
    baseCost: 400,
    costTiers: {"1":400},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 22,
    toughness: 13,
    save: 2,
  },
  {
    id: "necron-warriors-000000534",
    name: "Necron Warriors",
    baseCost: 90,
    costTiers: {"10":90,"20":200},
    modelsPerUnit: { min: 10, max: 20 },
    wounds: 1,
    toughness: 4,
    save: 4,
  },
  {
    id: "nemesor-zahndrekh-000000527",
    name: "Nemesor Zahndrekh",
    baseCost: 85,
    costTiers: {"1":85},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 5,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "night-scythe-000000544",
    name: "Night Scythe",
    baseCost: 145,
    costTiers: {"1":145},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 12,
    toughness: 9,
    save: 3,
  },
  {
    id: "night-shroud-000000561",
    name: "Night Shroud",
    baseCost: 140,
    costTiers: {"1":140},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 14,
    toughness: 9,
    save: 3,
  },
  {
    id: "obelisk-000000557",
    name: "Obelisk",
    baseCost: 300,
    costTiers: {"1":300},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 24,
    toughness: 13,
    save: 2,
  },
  {
    id: "ophydian-destroyers-000002358",
    name: "Ophydian Destroyers",
    baseCost: 80,
    costTiers: {"3":80,"6":160},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 3,
    toughness: 5,
    save: 4,
  },
  {
    id: "orikan-the-diviner-000000530",
    name: "Orikan The Diviner",
    baseCost: 80,
    costTiers: {"1":80},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 4,
    toughness: 4,
    save: 4,
    invulnSave: 4,
  },
  {
    id: "overlord-000000523",
    name: "Overlord",
    baseCost: 85,
    costTiers: {"1":85},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 5,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "overlord-with-translocation-shroud-000003693",
    name: "Overlord with translocation shroud",
    baseCost: 85,
    costTiers: {"1":85},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 5,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "plasmancer-000002108",
    name: "Plasmancer",
    baseCost: 55,
    costTiers: {"1":55},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 4,
    toughness: 4,
    save: 4,
  },
  {
    id: "psychomancer-000002353",
    name: "Psychomancer",
    baseCost: 55,
    costTiers: {"1":55},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 4,
    toughness: 4,
    save: 4,
  },
  {
    id: "royal-warden-000002350",
    name: "Royal Warden",
    baseCost: 50,
    costTiers: {"1":50},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 4,
    toughness: 5,
    save: 3,
  },
  {
    id: "sentry-pylon-000000562",
    name: "Sentry Pylon",
    baseCost: 120,
    costTiers: {"1":120},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 8,
    save: 3,
  },
  {
    id: "seraptek-heavy-construct-000001577",
    name: "Seraptek Heavy Construct",
    baseCost: 540,
    costTiers: {"1":540},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 24,
    toughness: 12,
    save: 3,
    invulnSave: 5,
  },
  {
    id: "skorpekh-destroyers-000002110",
    name: "Skorpekh Destroyers",
    baseCost: 90,
    costTiers: {"3":90,"6":180},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 3,
    toughness: 6,
    save: 3,
  },
  {
    id: "skorpekh-lord-000002109",
    name: "Skorpekh Lord",
    baseCost: 90,
    costTiers: {"1":90},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 7,
    toughness: 7,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "technomancer-000002352",
    name: "Technomancer",
    baseCost: 80,
    costTiers: {"1":80},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 4,
    toughness: 4,
    save: 4,
  },
  {
    id: "tesseract-ark-000000564",
    name: "Tesseract Ark",
    baseCost: 130,
    costTiers: {"1":130},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 10,
    toughness: 9,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "tesseract-vault-000000556",
    name: "Tesseract Vault",
    baseCost: 425,
    costTiers: {"1":425},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 24,
    toughness: 12,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "the-silent-king-000002360",
    name: "The Silent King",
    baseCost: 420,
    costTiers: {"3":420},
    modelsPerUnit: { min: 3, max: 3 },
    wounds: 16,
    toughness: 10,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "tomb-blades-000000548",
    name: "Tomb Blades",
    baseCost: 75,
    costTiers: {"3":75,"6":150},
    modelsPerUnit: { min: 3, max: 6 },
    wounds: 2,
    toughness: 5,
    save: 4,
  },
  {
    id: "tomb-citadel-walls-000002362",
    name: "Tomb Citadel Walls",
    baseCost: 920,
    costTiers: {"1":920},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 50,
    toughness: 13,
    save: 2,
    invulnSave: 5,
  },
  {
    id: "transcendent-c-tan-000000555",
    name: "Transcendent C’tan",
    baseCost: 295,
    costTiers: {"1":295},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 12,
    toughness: 11,
    save: 4,
    invulnSave: 4,
  },
  {
    id: "trazyn-the-infinite-000000532",
    name: "Trazyn The Infinite",
    baseCost: 75,
    costTiers: {"1":75},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 6,
    toughness: 5,
    save: 2,
    invulnSave: 4,
  },
  {
    id: "triarch-praetorians-000000539",
    name: "Triarch Praetorians",
    baseCost: 100,
    costTiers: {"5":100,"10":200},
    modelsPerUnit: { min: 5, max: 10 },
    wounds: 2,
    toughness: 5,
    save: 3,
  },
  {
    id: "triarch-stalker-000000540",
    name: "Triarch Stalker",
    baseCost: 110,
    costTiers: {"1":110},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 12,
    toughness: 8,
    save: 3,
    invulnSave: 4,
  },
  {
    id: "vargard-obyron-000000528",
    name: "Vargard Obyron",
    baseCost: 85,
    costTiers: {"1":85},
    modelsPerUnit: { min: 1, max: 1 },
    wounds: 5,
    toughness: 5,
    save: 2,
  },
];

export function getUnitById(id: string): Unit | undefined {
  return UNITS.find(u => u.id === id);
}

export function calculateUnitCost(unit: Unit, modelCount: number): number {
  if (unit.costTiers[modelCount] != null) return unit.costTiers[modelCount];
  const sizes = Object.keys(unit.costTiers).map(n => parseInt(n, 10)).sort((a,b)=>a-b);
  const within = sizes.filter(n => n >= unit.modelsPerUnit.min && n <= unit.modelsPerUnit.max);
  if (within.length === 0) return 0;
  let closest = within[0]; let best = Math.abs(modelCount - closest);
  for (const n of within) { const d = Math.abs(modelCount - n); if (d < best) { best = d; closest = n; } }
  return unit.costTiers[closest] ?? 0;
}
